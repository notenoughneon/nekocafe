<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1,
        user-scalable=no">
        <title>nekocafe</title>
        <link href="bootstrap.min.css" rel="stylesheet">
        <style>
            html, body, .container {
                height: 100%;
            }
            #loginScreen {
                height: 100%;
                width: 100%;
                background-color: #d0d0d0;
            }
            #chatScreen {
                display: none;
            }
            #chatScreen ul {
                list-style-type: none;
                margin: 0;
                padding: 0;
                padding-bottom: 50px;
            }
            #chatForm {
                position: fixed;
                bottom: 0;
            }
        </style>
    </head>
    <body>
        <div id="loginScreen">
            <form id="loginForm" class="form-inline">
                <input id="nick" class="form-control" placeholder="What is your neko name?" type="text" />
                <button class="btn btn-default">Connect</button>
            </form>
        </div>

        <div id="chatScreen" class="container">
            <ul id="messages"></ul>
            <form id="chatForm" action="">
                <div class="input-group">
                    <input id="message" class="form-control" placeholder="Enter message" autocomplete="off" />
                    <span class="input-group-btn">
                        <button class="btn btn-default">Send</button>
                    </span>
                </div>
            </form>
        </div>

        <script src="/socket.io/socket.io.js"></script>
        <script src="/jquery-2.1.3.min.js"></script>
        <script>
            var socket;
            function log(msg) {
                $('#messages').append($('<li>').text(msg));
                $("html, body").animate({ scrollTop: $(document).height()-$(window).height() }, 10);
            }
            $('#chatForm').submit(function() {
                socket.emit('message', $('#message').val());
                $('#message').val('');
                return false;
            });
            $('#loginForm').submit(function() {
                $('#loginScreen').hide();
                $('#chatScreen').show();
                socket = io();
                socket.on('connect', function() {
                    socket.emit('nick', $('#nick').val());
                });
                socket.on('join', function(nick) {
                    log('* ' + nick + ' joined.');
                });
                socket.on('part', function(nick) {
                    log('* ' + nick + ' left.');
                });
                socket.on('message', function(m) {
                    log('<' + m.nick + '> ' + m.message);
                });
                socket.on('nicks', function(nicks) {
                    log('You are in Neko Cafe.');
                    log('Nekoes here: ' + nicks.join(', ') + '.');
                });
                return false;
            });
        </script>
    </body>
</html>
